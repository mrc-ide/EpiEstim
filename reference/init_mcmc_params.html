<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>init_mcmc_params Finds clever starting points for the MCMC to be used to estimate the serial interval, e.g. when using option si_from_data in estimate_R — init_mcmc_params • EpiEstim</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="init_mcmc_params Finds clever starting points for the MCMC to be used to estimate the serial interval, e.g. when using option si_from_data in estimate_R — init_mcmc_params"><meta property="og:description" content="init_mcmc_params Finds values of the serial interval distribution
parameters, used to initialise the MCMC estimation of the serial interval
distribution. Initial values are computed based on the observed mean and
standard deviation of the sample from which the parameters are to be
estimated."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiEstim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/alternative_software.html">Alternative software for estimating the reproduction number</a>
    </li>
    <li>
      <a href="../articles/EpiEstim_aggregated_data.html">EpiEstim for aggregated incidence data</a>
    </li>
    <li>
      <a href="../articles/EpiEstim_backimputation.html">Dealing with missed generations of infections with EpiEstim</a>
    </li>
    <li>
      <a href="../articles/full_EpiEstim_vignette.html">EpiEstim Vignette</a>
    </li>
    <li>
      <a href="../articles/MV_EpiEstim_vignette.html">MV-EpiEstim</a>
    </li>
    <li>
      <a href="../articles/short_demo.html">EpiEstim: a demonstration</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mrc-ide/EpiEstim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>init_mcmc_params Finds clever starting points for the MCMC to be used to estimate the serial interval, e.g. when using option <code>si_from_data</code> in <code>estimate_R</code></h1>
    <small class="dont-index">Source: <a href="https://github.com/mrc-ide/EpiEstim/blob/master/R/init_mcmc_params.R" class="external-link"><code>R/init_mcmc_params.R</code></a></small>
    <div class="hidden name"><code>init_mcmc_params.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>init_mcmc_params</code> Finds values of the serial interval distribution
parameters, used to initialise the MCMC estimation of the serial interval
distribution. Initial values are computed based on the observed mean and
standard deviation of the sample from which the parameters are to be
estimated.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">init_mcmc_params</span><span class="op">(</span><span class="va">si_data</span>, dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="st">"W"</span>, <span class="st">"L"</span>, <span class="st">"off1G"</span>, <span class="st">"off1W"</span>, <span class="st">"off1L"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-si-data">si_data<a class="anchor" aria-label="anchor" href="#arg-si-data"></a></dt>
<dd><p>the data on dates of symptoms of pairs of infector/infected
individuals to be used to estimate the serial interval distribution. This
should be a dataframe with 5 columns:</p><ul><li><p>EL: the lower bound
of the symptom onset date of the infector (given as an integer)</p></li>
<li><p>ER:
the upper bound of the symptom onset date of the infector (given as an
integer). Should be such that ER&gt;=EL. If the dates are known exactly use
ER = EL</p></li>
<li><p>SL: the lower bound of the
symptom onset date of the infected individual (given as an integer)</p></li>
<li><p>SR: the upper bound of the symptom onset date of the infected
individual (given as an integer). Should be such that SR&gt;=SL. If the dates
are known exactly use SR = SL</p></li>
<li><p>type
(optional): can have entries 0, 1, or 2, corresponding to doubly
interval-censored, single interval-censored or exact observations,
respectively, see Reich et al. Statist. Med. 2009. If not specified, this
will be automatically computed from the dates</p></li>
</ul></dd>


<dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>the parametric distribution to use for the serial interval.
Should be one of "G" (Gamma), "W" (Weibull), "L" (Lognormal), "off1G"
(Gamma shifted by 1), "off1W" (Weibull shifted by 1), or "off1L" (Lognormal
shifted by 1).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A vector containing the initial values for the two parameters of the
  distribution of the serial interval. These are the shape and scale for all
  but the lognormal distribution, for which it is the meanlog and sdlog.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="estimate_R.html">estimate_R</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Anne Cori</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## Note the following examples use an MCMC routine</span></span></span>
<span class="r-in"><span><span class="co">## to estimate the serial interval distribution from data,</span></span></span>
<span class="r-in"><span><span class="co">## so they may take a few minutes to run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## load data on rotavirus</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"MockRotavirus"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## get clever initial values for shape and scale of a Gamma distribution</span></span></span>
<span class="r-in"><span><span class="co">## fitted to the the data MockRotavirus$si_data</span></span></span>
<span class="r-in"><span><span class="va">clever_init_param</span> <span class="op">&lt;-</span> <span class="fu">init_mcmc_params</span><span class="op">(</span><span class="va">MockRotavirus</span><span class="op">$</span><span class="va">si_data</span>, <span class="st">"G"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## estimate the serial interval from data using a clever starting point for </span></span></span>
<span class="r-in"><span><span class="co">## the MCMC chain</span></span></span>
<span class="r-in"><span><span class="va">SI_fit_clever</span> <span class="op">&lt;-</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu"><a href="http://nickreich.github.io/coarseDataTools/reference/dic.fit.mcmc.html" class="external-link">dic.fit.mcmc</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">MockRotavirus</span><span class="op">$</span><span class="va">si_data</span>,</span></span>
<span class="r-in"><span>                             dist <span class="op">=</span> <span class="st">"G"</span>,</span></span>
<span class="r-in"><span>                             init.pars <span class="op">=</span> <span class="va">clever_init_param</span>,</span></span>
<span class="r-in"><span>                             burnin <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>                             n.samples <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## estimate the serial interval from data using a random starting point for </span></span></span>
<span class="r-in"><span><span class="co">## the MCMC chain</span></span></span>
<span class="r-in"><span><span class="va">SI_fit_naive</span> <span class="op">&lt;-</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu"><a href="http://nickreich.github.io/coarseDataTools/reference/dic.fit.mcmc.html" class="external-link">dic.fit.mcmc</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">MockRotavirus</span><span class="op">$</span><span class="va">si_data</span>,</span></span>
<span class="r-in"><span>                             dist <span class="op">=</span> <span class="st">"G"</span>,</span></span>
<span class="r-in"><span>                             burnin <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>                             n.samples <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## use check_cdt_samples_convergence to check convergence in both situations</span></span></span>
<span class="r-in"><span><span class="va">converg_diag_clever</span> <span class="op">&lt;-</span> <span class="fu"><a href="check_cdt_samples_convergence.html">check_cdt_samples_convergence</a></span><span class="op">(</span><span class="va">SI_fit_clever</span><span class="op">@</span><span class="va">samples</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">converg_diag_naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="check_cdt_samples_convergence.html">check_cdt_samples_convergence</a></span><span class="op">(</span><span class="va">SI_fit_naive</span><span class="op">@</span><span class="va">samples</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">converg_diag_clever</span></span></span>
<span class="r-in"><span><span class="va">converg_diag_naive</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Anne Cori.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer></div>






  </body></html>

