<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Set and check parameter settings of estimate_R — make_config • EpiEstim</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Set and check parameter settings of estimate_R — make_config" />
<meta property="og:description" content="This function defines settings for estimate_R  It takes a list of named
items as input, set defaults where arguments are
missing, and return a list of settings." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiEstim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2-4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/demo.html">EpiEstim: a demonstration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mrc-ide/EpiEstim/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Set and check parameter settings of estimate_R</h1>
    <small class="dont-index">Source: <a href='https://github.com/mrc-ide/EpiEstim/blob/master/R/make_config.R'><code>R/make_config.R</code></a></small>
    <div class="hidden name"><code>make_config.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function defines settings for estimate_R  It takes a list of named
items as input, set defaults where arguments are
missing, and return a list of settings.</p>
    </div>

    <pre class="usage"><span class='fu'>make_config</span><span class='op'>(</span>
  <span class='va'>...</span>,
  incid <span class='op'>=</span> <span class='cn'>NULL</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"non_parametric_si"</span>, <span class='st'>"parametric_si"</span>, <span class='st'>"uncertain_si"</span>, <span class='st'>"si_from_data"</span>,
    <span class='st'>"si_from_sample"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>Acceptable arguments for ... are:</p>
<dl>

<dt>t_start</dt><dd><p>Vector of positive integers giving the starting times of each
window over which the reproduction number will be estimated. These must be in
 ascending order, and so that for all <code>i</code>, <code>t_start[i]&lt;=t_end[i]</code>.
 t_start[1] should be strictly after the first day with non null incidence.</p></dd>
 
<dt>t_end</dt><dd><p>Vector of positive integers giving the ending times of each
window over which the reproduction number will be estimated. These must be
in ascending order, and so that for all <code>i</code>,
<code>t_start[i]&lt;=t_end[i]</code>.</p></dd>

<dt>n1</dt><dd><p>For method "uncertain_si" and "si_from_data"; positive integer
giving the size of the sample of SI distributions to be drawn (see details).</p></dd>

<dt>n2</dt><dd><p>For methods "uncertain_si", "si_from_data" and "si_from_sample";
positive integer giving the size of the sample drawn from the posterior
distribution of R for each serial interval distribution considered (see
details).</p></dd>

<dt>mean_si</dt><dd><p>For method "parametric_si" and "uncertain_si" ; positive real
giving the mean serial interval (method "parametric_si") or the average mean
serial interval (method "uncertain_si", see details).</p></dd>

<dt>std_si</dt><dd><p>For method "parametric_si" and "uncertain_si" ; non negative
real giving the standard deviation of the serial interval
(method "parametric_si") or the average standard deviation of the serial
interval (method "uncertain_si", see details).</p></dd>

<dt>std_mean_si</dt><dd><p>For method "uncertain_si" ; standard deviation of the
distribution from which mean serial intervals are drawn (see details).</p></dd>

<dt>min_mean_si</dt><dd><p>For method "uncertain_si" ; lower bound of the
distribution from which mean serial intervals are drawn (see details).</p></dd>

<dt>max_mean_si</dt><dd><p>For method "uncertain_si" ; upper bound of the
distribution from which mean serial intervals are drawn (see details).</p></dd>

<dt>std_std_si</dt><dd><p>For method "uncertain_si" ; standard deviation of the
distribution from which standard deviations of the serial interval are drawn
(see details).</p></dd>

<dt>min_std_si</dt><dd><p>For method "uncertain_si" ; lower bound of the distribution
 from which standard deviations of the serial interval are drawn (see
 details).</p></dd>
 
<dt>max_std_si</dt><dd><p>For method "uncertain_si" ; upper bound of the distribution
 from which standard deviations of the serial interval are drawn (see
 details).</p></dd>
 
<dt>si_distr</dt><dd><p>For method "non_parametric_si" ; vector of probabilities
giving the discrete distribution of the serial interval, starting with
<code>si_distr[1]</code> (probability that the serial interval is zero), which
should be zero.</p></dd>

<dt>si_parametric_distr</dt><dd><p>For method "si_from_data" ; the parametric
distribution to use when estimating the serial interval from data on dates of
 symptoms of pairs of infector/infected individuals (see details).
Should be one of "G" (Gamma), "W" (Weibull), "L" (Lognormal), "off1G" (Gamma
shifted by 1), "off1W" (Weibull shifted by 1), or "off1L" (Lognormal shifted
by 1).</p></dd>

<dt>mcmc_control</dt><dd><p>An object of class <code>estimate_R_mcmc_control</code>, as 
returned by function <code>make_mcmc_control</code>.</p></dd>

<dt>seed</dt><dd><p>An optional integer used as the seed for the random number
generator at the start of the function (then potentially reset within the
MCMC for method <code>si_from_data</code>); useful to get reproducible results.</p></dd>

<dt>mean_prior</dt><dd><p>A positive number giving the mean of the common prior
distribution for all reproduction numbers (see details).</p></dd>

<dt>std_prior</dt><dd><p>A positive number giving the standard deviation of the
common prior distribution for all reproduction numbers (see details).</p></dd>

<dt>cv_posterior</dt><dd><p>A positive number giving the aimed posterior coefficient
of variation (see details).</p></dd>


</dl></td>
    </tr>
    <tr>
      <th>incid</th>
      <td><p>As in function<code>estimate_R</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>As in function<code>estimate_R</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>estimate_R_config</code> with components 
t_start, t_end, n1, n2, mean_si, std_si, 
std_mean_si, min_mean_si, max_mean_si, std_std_si, min_std_si, max_std_si,
si_distr, si_parametric_distr, mcmc_control, seed, mean_prior, std_prior, 
cv_posterior, which can be used as an argument of function <code>estimate_R</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Analytical estimates of the reproduction number for an epidemic over
predefined time windows can be obtained using function <code>estimate_R</code>,  
for a given discrete distribution of the serial interval. <code>make_config</code>
allows to generate a configuration specifying the way the estimation will
be performed.</p>
<p>The more incident cases are observed over a time window, the smallest the
posterior coefficient of variation (CV, ratio of standard deviation over
mean) of the reproduction number.
An aimed CV can be specified in the argument <code>cv_posterior</code> 
(default is <code>0.3</code>), and a warning will be produced if the incidence 
within one of the time windows considered is too low to get this CV.</p>
<p>The methods vary in the way the serial interval distribution is specified.</p>
<p>In short there are five methods to specify the serial interval distribution
(see below for details on each method).
In the first two methods, a unique serial interval distribution is
considered, whereas in the last three, a range of serial interval
distributions are integrated over:</p><ul>
<li><p>In method "non_parametric_si" the user specifies the discrete
distribution of the serial interval</p></li>
<li><p>In method "parametric_si" the user specifies the mean and sd of the
serial interval</p></li>
<li><p>In method "uncertain_si" the mean and sd of the serial interval are
each drawn from truncated normal distributions, with parameters specified by
the user</p></li>
<li><p>In method "si_from_data", the serial interval distribution is directly
estimated, using MCMC, from interval censored exposure data, with data
provided by the user together with a choice of parametric distribution for
the serial interval</p></li>
<li><p>In method "si_from_sample", the user directly provides the sample of
serial interval distribution to use for estimation of R. This can be a useful
 alternative to the previous method, where the MCMC estimation of the serial
 interval distribution could be run once, and the same estimated SI
 distribution then used in estimate_R in different contexts, e.g. with
 different time windows, hence avoiding to rerun the MCMC everytime
 estimate_R is called.</p></li>
</ul>

<p>----------------------- <code>method "non_parametric_si"</code> -------------------</p>
<p>The discrete distribution of the serial interval is directly specified in the
 argument <code>si_distr</code>.</p>
<p>----------------------- <code>method "parametric_si"</code> -----------------------</p>
<p>The mean and standard deviation of the continuous distribution of the serial
interval are given in the arguments <code>mean_si</code> and <code>std_si</code>.
The discrete distribution of the serial interval is derived automatically
using <code><a href='discr_si.html'>discr_si</a></code>.</p>
<p>----------------------- <code>method "uncertain_si"</code> -----------------------</p>
<p><code>Method "uncertain_si"</code> allows accounting for uncertainty on the serial
interval distribution as described in Cori et al. AJE 2013.
We allow the mean \(\mu\) and standard deviation \(\sigma\) of the serial
 interval to vary according to truncated normal distributions.
We sample <code>n1</code> pairs of mean and standard deviations,
\((\mu^{(1)},\sigma^{(1)}),...,(\mu^{(n_2)},\sigma^{(n_2)})\), by first
sampling the mean \(\mu^{(k)}\)
from its truncated normal distribution (with mean <code>mean_si</code>, standard
deviation <code>std_mean_si</code>, minimum <code>min_mean_si</code> and maximum
<code>max_mean_si</code>),
and then sampling the standard deviation \(\sigma^{(k)}\) from its
truncated normal distribution
(with mean <code>std_si</code>, standard deviation <code>std_std_si</code>, minimum
<code>min_std_si</code> and maximum <code>max_std_si</code>), but imposing that
\(\sigma^{(k)}&lt;\mu^{(k)}\).
This constraint ensures that the Gamma probability density function of the
serial interval is null at \(t=0\).
Warnings are produced when the truncated normal distributions are not
symmetric around the mean.
For each pair \((\mu^{(k)},\sigma^{(k)})\), we then draw a sample of size
<code>n2</code> in the posterior distribution of the reproduction number over each
time window, conditionally on this serial interval distribution.
After pooling, a sample of size \(\code{n1}\times\code{n2}\) of the joint
posterior distribution of the reproduction number over each time window is
obtained.
The posterior mean, standard deviation, and 0.025, 0.05, 0.25, 0.5, 0.75,
0.95, 0.975 quantiles of the reproduction number for each time window are
obtained from this sample.</p>
<p>----------------------- <code>method "si_from_data"</code> -----------------------</p>
<p><code>Method "si_from_data"</code> allows accounting for uncertainty on the serial
interval distribution.
Unlike method "uncertain_si", where we arbitrarily vary the mean and std of
the SI in truncated normal distributions,
here, the scope of serial interval distributions considered is directly
informed by data
on the (potentially censored) dates of symptoms of pairs of infector/infected
 individuals.
This data, specified in argument <code>si_data</code>, should be a dataframe with 5
 columns:</p><ul>
<li><p>EL: the lower bound of the symptom onset date of the infector (given as
 an integer)</p></li>
<li><p>ER: the upper bound of the symptom onset date of the infector (given as
 an integer). Should be such that ER&gt;=EL</p></li>
<li><p>SL: the lower bound of the symptom onset date of the infected
individual (given as an integer)</p></li>
<li><p>SR: the upper bound of the symptom onset date of the infected
individual (given as an integer). Should be such that SR&gt;=SL</p></li>
<li><p>type (optional): can have entries 0, 1, or 2, corresponding to doubly
interval-censored, single interval-censored or exact observations,
respectively, see Reich et al. Statist. Med. 2009. If not specified, this
will be automatically computed from the dates</p></li>
</ul><p>Assuming a given parametric distribution for the serial interval distribution
 (specified in si_parametric_distr),
the posterior distribution of the serial interval is estimated directly from
these data using MCMC methods implemented in the package
<code>coarsedatatools</code>.
The argument <code>mcmc_control</code> is a list of characteristics which control
the MCMC.
The MCMC is run for a total number of iterations of
<code>mcmc_control$burnin + n1*mcmc_control$thin</code>;
but the output is only recorded after the burnin, and only 1 in every
<code>mcmc_control$thin</code> iterations,
so that the posterior sample size is <code>n1</code>.
For each element in the posterior sample of serial interval distribution,
we then draw a sample of size <code>n2</code> in the posterior distribution of the
reproduction number over each time window,
conditionally on this serial interval distribution.
After pooling, a sample of size \(\code{n1}\times\code{n2}\) of the joint
posterior distribution of
the reproduction number over each time window is obtained.
The posterior mean, standard deviation, and 0.025, 0.05, 0.25, 0.5, 0.75,
0.95, 0.975 quantiles of the reproduction number for each time window are
obtained from this sample.</p>
<p>----------------------- <code>method "si_from_sample"</code> ----------------------</p>
<p><code>Method "si_from_sample"</code> also allows accounting for uncertainty on the
serial interval distribution.
Unlike methods "uncertain_si" and "si_from_data", the user directly provides
(in argument <code>si_sample</code>) a sample of serial interval distribution to be
 explored.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## Note the following examples use an MCMC routine</span>
<span class='co'>## to estimate the serial interval distribution from data,</span>
<span class='co'>## so they may take a few minutes to run</span>

<span class='co'>## load data on rotavirus</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"MockRotavirus"</span><span class='op'>)</span>

<span class='co'>## estimate the reproduction number (method "si_from_data")</span>
<span class='co'>## we are not specifying the time windows, so by defaults this will estimate</span>
<span class='co'>## R on sliding weekly windows</span>
<span class='va'>incid</span> <span class='op'>&lt;-</span> <span class='va'>MockRotavirus</span><span class='op'>$</span><span class='va'>incidence</span>
<span class='va'>method</span> <span class='op'>&lt;-</span> <span class='st'>"si_from_data"</span>
<span class='va'>config</span> <span class='op'>&lt;-</span> <span class='fu'>make_config</span><span class='op'>(</span>incid <span class='op'>=</span> <span class='va'>incid</span>, 
                     method <span class='op'>=</span> <span class='va'>method</span>, 
                     <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>si_parametric_distr <span class='op'>=</span> <span class='st'>"G"</span>,
                     mcmc_control <span class='op'>=</span> <span class='fu'><a href='make_mcmc_control.html'>make_mcmc_control</a></span><span class='op'>(</span>burnin <span class='op'>=</span> <span class='fl'>1000</span>, 
                     thin <span class='op'>=</span> <span class='fl'>10</span>, seed <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                     n1 <span class='op'>=</span> <span class='fl'>500</span>, 
                     n2 <span class='op'>=</span> <span class='fl'>50</span>,
                     seed <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>R_si_from_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='estimate_R.html'>estimate_R</a></span><span class='op'>(</span><span class='va'>incid</span>,
                            method <span class='op'>=</span> <span class='va'>method</span>,
                            si_data <span class='op'>=</span> <span class='va'>MockRotavirus</span><span class='op'>$</span><span class='va'>si_data</span>,
                            config <span class='op'>=</span> <span class='va'>config</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>R_si_from_data</span><span class='op'>)</span>                          

<span class='co'>## you can also create the config straight within the estimate_R call, </span>
<span class='co'>## in that case incid and method are automatically used from the estimate_R</span>
<span class='co'>## arguments:</span>
<span class='va'>R_si_from_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='estimate_R.html'>estimate_R</a></span><span class='op'>(</span><span class='va'>incid</span>,
                            method <span class='op'>=</span> <span class='va'>method</span>,
                            si_data <span class='op'>=</span> <span class='va'>MockRotavirus</span><span class='op'>$</span><span class='va'>si_data</span>,
                            config <span class='op'>=</span> <span class='fu'>make_config</span><span class='op'>(</span>
                     <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>si_parametric_distr <span class='op'>=</span> <span class='st'>"G"</span>,
                     mcmc_control <span class='op'>=</span> <span class='fu'><a href='make_mcmc_control.html'>make_mcmc_control</a></span><span class='op'>(</span>burnin <span class='op'>=</span> <span class='fl'>1000</span>, 
                     thin <span class='op'>=</span> <span class='fl'>10</span>, seed <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                     n1 <span class='op'>=</span> <span class='fl'>500</span>, 
                     n2 <span class='op'>=</span> <span class='fl'>50</span>,
                     seed <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>R_si_from_data</span><span class='op'>)</span>    
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Anne Cori.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


