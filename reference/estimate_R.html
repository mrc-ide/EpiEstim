<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimated Instantaneous Reproduction Number

estimate_R estimates the reproduction number of an epidemic, given the
incidence time series and the serial interval distribution. — estimate_R • EpiEstim</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimated Instantaneous Reproduction Number

estimate_R estimates the reproduction number of an epidemic, given the
incidence time series and the serial interval distribution. — estimate_R" />
<meta property="og:description" content="Estimated Instantaneous Reproduction Number
estimate_R estimates the reproduction number of an epidemic, given the
incidence time series and the serial interval distribution." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiEstim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2-4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/demo.html">EpiEstim: a demonstration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mrc-ide/EpiEstim/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimated Instantaneous Reproduction Number

<code>estimate_R</code> estimates the reproduction number of an epidemic, given the
incidence time series and the serial interval distribution.</h1>
    <small class="dont-index">Source: <a href='https://github.com/mrc-ide/EpiEstim/blob/master/R/estimate_r.R'><code>R/estimate_r.R</code></a></small>
    <div class="hidden name"><code>estimate_R.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimated Instantaneous Reproduction Number</p>
<p><code>estimate_R</code> estimates the reproduction number of an epidemic, given the
incidence time series and the serial interval distribution.</p>
    </div>

    <pre class="usage"><span class='fu'>estimate_R</span><span class='op'>(</span>
  <span class='va'>incid</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"non_parametric_si"</span>, <span class='st'>"parametric_si"</span>, <span class='st'>"uncertain_si"</span>, <span class='st'>"si_from_data"</span>,
    <span class='st'>"si_from_sample"</span><span class='op'>)</span>,
  si_data <span class='op'>=</span> <span class='cn'>NULL</span>,
  si_sample <span class='op'>=</span> <span class='cn'>NULL</span>,
  config <span class='op'>=</span> <span class='fu'><a href='make_config.html'>make_config</a></span><span class='op'>(</span>incid <span class='op'>=</span> <span class='va'>incid</span>, method <span class='op'>=</span> <span class='va'>method</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>incid</th>
      <td><p>One of the following</p><ul>
<li><p>A vector (or a dataframe with a single column) of non-negative integers
containing the incidence time series</p></li>
<li><p>A dataframe of non-negative integers with either i) <code>incid$I</code>
containing the total incidence, or ii) two columns, so that
<code>incid$local</code> contains the incidence of cases due to local transmission
and <code>incid$imported</code> contains the incidence of imported cases (with
<code>incid$local + incid$imported</code> the total incidence). If the dataframe
contains a column <code>incid$dates</code>, this is used for plotting.
<code>incid$dates</code> must contains only dates in a row.</p></li>
<li><p>An object of class <code>incidence</code></p></li>
</ul>

<p>Note that the cases from the first time step are always all assumed to be
imported cases.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>One of "non_parametric_si", "parametric_si", "uncertain_si",
"si_from_data" or "si_from_sample" (see details).</p></td>
    </tr>
    <tr>
      <th>si_data</th>
      <td><p>For method "si_from_data" ; the data on dates of symptoms of
pairs of infector/infected individuals to be used to estimate the serial
interval distribution (see details).</p></td>
    </tr>
    <tr>
      <th>si_sample</th>
      <td><p>For method "si_from_sample" ; a matrix where each column
gives one distribution of the serial interval to be explored (see details).</p></td>
    </tr>
    <tr>
      <th>config</th>
      <td><p>An object of class <code>estimate_R_config</code>, as returned by 
function <code>make_config</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class <code>estimate_R</code>, with components:
<ul>
<li><p>R: a dataframe containing:
the times of start and end of each time window considered ;
the posterior mean, std, and 0.025, 0.05, 0.25, 0.5, 0.75, 0.95, 0.975
quantiles of the reproduction number for each time window.</p></li>
<li><p>method: the method used to estimate R, one of "non_parametric_si",
"parametric_si", "uncertain_si", "si_from_data" or "si_from_sample"</p></li>
<li><p>si_distr: a vector or dataframe (depending on the method) containing
 the discrete serial interval distribution(s) used for estimation</p></li>
<li><p>SI.Moments: a vector or dataframe (depending on the method)
containing the mean and std of the discrete serial interval distribution(s)
used for estimation</p></li>
<li><p>I: the time series of total incidence</p></li>
<li><p>I_local: the time series of incidence of local cases (so that
<code>I_local + I_imported = I</code>)</p></li>
<li><p>I_imported: the time series of incidence of imported cases (so that
<code>I_local + I_imported = I</code>)</p></li>
<li><p>dates: a vector of dates corresponding to the incidence time series</p></li>
<li><p>MCMC_converged (only for method <code>si_from_data</code>): a boolean
showing whether the Gelman-Rubin MCMC convergence diagnostic was successful
(<code>TRUE</code>) or not (<code>FALSE</code>)</p></li>
</ul></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Analytical estimates of the reproduction number for an epidemic over
predefined time windows can be obtained within a Bayesian framework,
for a given discrete distribution of the serial interval (see references).</p>
<p>Several methods are available to specify the serial interval distribution.</p>
<p>In short there are five methods to specify the serial interval distribution
(see help for function <code>make_config</code> for more detail on each method).
In the first two methods, a unique serial interval distribution is
considered, whereas in the last three, a range of serial interval
distributions are integrated over:</p><ul>
<li><p>In method "non_parametric_si" the user specifies the discrete
distribution of the serial interval</p></li>
<li><p>In method "parametric_si" the user specifies the mean and sd of the
serial interval</p></li>
<li><p>In method "uncertain_si" the mean and sd of the serial interval are
each drawn from truncated normal distributions, with parameters specified by
the user</p></li>
<li><p>In method "si_from_data", the serial interval distribution is directly
estimated, using MCMC, from interval censored exposure data, with data
provided by the user together with a choice of parametric distribution for
the serial interval</p></li>
<li><p>In method "si_from_sample", the user directly provides the sample of
serial interval distribution to use for estimation of R. This can be a useful
 alternative to the previous method, where the MCMC estimation of the serial
 interval distribution could be run once, and the same estimated SI
 distribution then used in estimate_R in different contexts, e.g. with
 different time windows, hence avoiding to rerun the MCMC every time
 estimate_R is called.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cori, A. et al. A new framework and software to estimate time-varying
reproduction numbers during epidemics (AJE 2013).
Wallinga, J. and P. Teunis. Different epidemic curves for severe acute
respiratory syndrome reveal similar impacts of control measures (AJE 2004).
Reich, N.G. et al. Estimating incubation period distributions with coarse
data (Statis. Med. 2009)</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='discr_si.html'>discr_si</a></code> <code><a href='make_config.html'>make_config</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Anne Cori <a href='mailto:a.cori@imperial.ac.uk'>a.cori@imperial.ac.uk</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## load data on pandemic flu in a school in 2009</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"Flu2009"</span><span class='op'>)</span>

<span class='co'>## estimate the reproduction number (method "non_parametric_si")</span>
<span class='co'>## when not specifying t_start and t_end in config, they are set to estimate</span>
<span class='co'>## the reproduction number on sliding weekly windows                          </span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>estimate_R</span><span class='op'>(</span>incid <span class='op'>=</span> <span class='va'>Flu2009</span><span class='op'>$</span><span class='va'>incidence</span>, 
                  method <span class='op'>=</span> <span class='st'>"non_parametric_si"</span>,
                  config <span class='op'>=</span> <span class='fu'><a href='make_config.html'>make_config</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>si_distr <span class='op'>=</span> <span class='va'>Flu2009</span><span class='op'>$</span><span class='va'>si_distr</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Default config will estimate R on weekly sliding windows.</span>
#&gt; <span class='message'>    To change this change the t_start and t_end arguments. </span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='img'><img src='estimate_R-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## the second plot produced shows, at each each day,</span>
<span class='co'>## the estimate of the reproduction number over the 7-day window </span>
<span class='co'>## finishing on that day.</span>

<span class='co'>## to specify t_start and t_end in config, e.g. to have biweekly sliding</span>
<span class='co'>## windows      </span>
<span class='va'>t_start</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Flu2009</span><span class='op'>$</span><span class='va'>incidence</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>13</span><span class='op'>)</span>   
<span class='va'>t_end</span> <span class='op'>&lt;-</span> <span class='va'>t_start</span> <span class='op'>+</span> <span class='fl'>13</span>                 
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>estimate_R</span><span class='op'>(</span>incid <span class='op'>=</span> <span class='va'>Flu2009</span><span class='op'>$</span><span class='va'>incidence</span>, 
                  method <span class='op'>=</span> <span class='st'>"non_parametric_si"</span>,
                  config <span class='op'>=</span> <span class='fu'><a href='make_config.html'>make_config</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
                      si_distr <span class='op'>=</span> <span class='va'>Flu2009</span><span class='op'>$</span><span class='va'>si_distr</span>, 
                      t_start <span class='op'>=</span> <span class='va'>t_start</span>, 
                      t_end <span class='op'>=</span> <span class='va'>t_end</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='img'><img src='estimate_R-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## the second plot produced shows, at each each day,</span>
<span class='co'>## the estimate of the reproduction number over the 14-day window </span>
<span class='co'>## finishing on that day.</span>

<span class='co'>## example with an incidence object</span>

<span class='co'>## create fake data</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.repidemicsconsortium.org/incidence/'>incidence</a></span><span class='op'>)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>26</span>,<span class='fl'>6</span>,<span class='fl'>7</span>,<span class='fl'>9</span><span class='op'>)</span>
<span class='va'>location</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"local"</span>,<span class='st'>"imported"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>, replace<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>location</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"imported"</span> <span class='co'># forcing the first case to be imported</span>

<span class='co'>## get incidence per group (location)</span>
<span class='va'>incid</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.repidemicsconsortium.org/incidence/reference/incidence.html'>incidence</a></span><span class='op'>(</span><span class='va'>data</span>, groups <span class='op'>=</span> <span class='va'>location</span><span class='op'>)</span>

<span class='co'>## Estimate R with assumptions on serial interval</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>estimate_R</span><span class='op'>(</span><span class='va'>incid</span>, method <span class='op'>=</span> <span class='st'>"parametric_si"</span>,
                  config <span class='op'>=</span> <span class='fu'><a href='make_config.html'>make_config</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
                  mean_si <span class='op'>=</span> <span class='fl'>2.6</span>, std_si <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Default config will estimate R on weekly sliding windows.</span>
#&gt; <span class='message'>    To change this change the t_start and t_end arguments. </span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='img'><img src='estimate_R-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## the second plot produced shows, at each each day,</span>
<span class='co'>## the estimate of the reproduction number over the 7-day window</span>
<span class='co'>## finishing on that day.</span>

<span class='co'>## estimate the reproduction number (method "parametric_si")</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>estimate_R</span><span class='op'>(</span><span class='va'>Flu2009</span><span class='op'>$</span><span class='va'>incidence</span>, method <span class='op'>=</span> <span class='st'>"parametric_si"</span>,
                  config <span class='op'>=</span> <span class='fu'><a href='make_config.html'>make_config</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean_si <span class='op'>=</span> <span class='fl'>2.6</span>, std_si <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Default config will estimate R on weekly sliding windows.</span>
#&gt; <span class='message'>    To change this change the t_start and t_end arguments. </span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='img'><img src='estimate_R-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## the second plot produced shows, at each each day,</span>
<span class='co'>## the estimate of the reproduction number over the 7-day window</span>
<span class='co'>## finishing on that day.</span>

<span class='co'>## estimate the reproduction number (method "uncertain_si")</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>estimate_R</span><span class='op'>(</span><span class='va'>Flu2009</span><span class='op'>$</span><span class='va'>incidence</span>, method <span class='op'>=</span> <span class='st'>"uncertain_si"</span>,
                  config <span class='op'>=</span> <span class='fu'><a href='make_config.html'>make_config</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
                  mean_si <span class='op'>=</span> <span class='fl'>2.6</span>, std_mean_si <span class='op'>=</span> <span class='fl'>1</span>,
                  min_mean_si <span class='op'>=</span> <span class='fl'>1</span>, max_mean_si <span class='op'>=</span> <span class='fl'>4.2</span>,
                  std_si <span class='op'>=</span> <span class='fl'>1.5</span>, std_std_si <span class='op'>=</span> <span class='fl'>0.5</span>,
                  min_std_si <span class='op'>=</span> <span class='fl'>0.5</span>, max_std_si <span class='op'>=</span> <span class='fl'>2.5</span>,
                  n1 <span class='op'>=</span> <span class='fl'>100</span>, n2 <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Default config will estimate R on weekly sliding windows.</span>
#&gt; <span class='message'>    To change this change the t_start and t_end arguments. </span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='img'><img src='estimate_R-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## the bottom left plot produced shows, at each each day,</span>
<span class='co'>## the estimate of the reproduction number over the 7-day window</span>
<span class='co'>## finishing on that day.</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## Note the following examples use an MCMC routine</span>
<span class='co'>## to estimate the serial interval distribution from data,</span>
<span class='co'>## so they may take a few minutes to run</span>

<span class='co'>## load data on rotavirus</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"MockRotavirus"</span><span class='op'>)</span>

<span class='co'>## estimate the reproduction number (method "si_from_data")</span>
<span class='va'>MCMC_seed</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>overall_seed</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>
<span class='va'>R_si_from_data</span> <span class='op'>&lt;-</span> <span class='fu'>estimate_R</span><span class='op'>(</span><span class='va'>MockRotavirus</span><span class='op'>$</span><span class='va'>incidence</span>,
                            method <span class='op'>=</span> <span class='st'>"si_from_data"</span>,
                            si_data <span class='op'>=</span> <span class='va'>MockRotavirus</span><span class='op'>$</span><span class='va'>si_data</span>,
                            config <span class='op'>=</span> <span class='fu'><a href='make_config.html'>make_config</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>si_parametric_distr <span class='op'>=</span> <span class='st'>"G"</span>,
                                        mcmc_control <span class='op'>=</span> <span class='fu'><a href='make_mcmc_control.html'>make_mcmc_control</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>burnin <span class='op'>=</span> <span class='fl'>1000</span>,
                                        thin <span class='op'>=</span> <span class='fl'>10</span>, seed <span class='op'>=</span> <span class='va'>MCMC_seed</span><span class='op'>)</span>,
                                        n1 <span class='op'>=</span> <span class='fl'>500</span>, n2 <span class='op'>=</span> <span class='fl'>50</span>,
                                        seed <span class='op'>=</span> <span class='va'>overall_seed</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## compare with version with no uncertainty</span>
<span class='va'>R_Parametric</span> <span class='op'>&lt;-</span> <span class='fu'>estimate_R</span><span class='op'>(</span><span class='va'>MockRotavirus</span><span class='op'>$</span><span class='va'>incidence</span>,
                          method <span class='op'>=</span> <span class='st'>"parametric_si"</span>,
                          config <span class='op'>=</span> <span class='fu'><a href='make_config.html'>make_config</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
                          mean_si <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>R_si_from_data</span><span class='op'>$</span><span class='va'>SI.Moments</span><span class='op'>$</span><span class='va'>Mean</span><span class='op'>)</span>,
                             std_si <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>R_si_from_data</span><span class='op'>$</span><span class='va'>SI.Moments</span><span class='op'>$</span><span class='va'>Std</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>## generate plots</span>
<span class='va'>p_uncertainty</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>R_si_from_data</span>, <span class='st'>"R"</span>, options_R<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>p_no_uncertainty</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>R_Parametric</span>, <span class='st'>"R"</span>, options_R<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>gridExtra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html'>grid.arrange</a></span><span class='op'>(</span><span class='va'>p_uncertainty</span>, <span class='va'>p_no_uncertainty</span>,ncol<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>

<span class='co'>## the left hand side graph is with uncertainty in the SI distribution, the</span>
<span class='co'>## right hand side without.</span>
<span class='co'>## The credible intervals are wider when accounting for uncertainty in the SI</span>
<span class='co'>## distribution.</span>

<span class='co'>## estimate the reproduction number (method "si_from_sample")</span>
<span class='va'>MCMC_seed</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>overall_seed</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>
<span class='va'>SI.fit</span> <span class='op'>&lt;-</span> <span class='fu'>coarseDataTools</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coarseDataTools/man/dic.fit.mcmc.html'>dic.fit.mcmc</a></span><span class='op'>(</span>dat <span class='op'>=</span> <span class='va'>MockRotavirus</span><span class='op'>$</span><span class='va'>si_data</span>,
                 dist <span class='op'>=</span> <span class='st'>"G"</span>,
                 init.pars <span class='op'>=</span> <span class='fu'><a href='init_mcmc_params.html'>init_mcmc_params</a></span><span class='op'>(</span><span class='va'>MockRotavirus</span><span class='op'>$</span><span class='va'>si_data</span>, <span class='st'>"G"</span><span class='op'>)</span>,
                 burnin <span class='op'>=</span> <span class='fl'>1000</span>,
                 n.samples <span class='op'>=</span> <span class='fl'>5000</span>,
                 seed <span class='op'>=</span> <span class='va'>MCMC_seed</span><span class='op'>)</span>
<span class='va'>si_sample</span> <span class='op'>&lt;-</span> <span class='fu'><a href='coarse2estim.html'>coarse2estim</a></span><span class='op'>(</span><span class='va'>SI.fit</span>, thin <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>$</span><span class='va'>si_sample</span>
<span class='va'>R_si_from_sample</span> <span class='op'>&lt;-</span> <span class='fu'>estimate_R</span><span class='op'>(</span><span class='va'>MockRotavirus</span><span class='op'>$</span><span class='va'>incidence</span>,
                               method <span class='op'>=</span> <span class='st'>"si_from_sample"</span>,
                               si_sample <span class='op'>=</span> <span class='va'>si_sample</span>,
                               config <span class='op'>=</span> <span class='fu'><a href='make_config.html'>make_config</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>n2 <span class='op'>=</span> <span class='fl'>50</span>, 
                               seed <span class='op'>=</span> <span class='va'>overall_seed</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>R_si_from_sample</span><span class='op'>)</span>

<span class='co'>## check that R_si_from_sample is the same as R_si_from_data</span>
<span class='co'>## since they were generated using the same MCMC algorithm to generate the SI</span>
<span class='co'>## sample (either internally to EpiEstim or externally)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>R_si_from_sample</span><span class='op'>$</span><span class='va'>R</span><span class='op'>$</span><span class='va'>`Mean(R)`</span> <span class='op'>==</span> <span class='va'>R_si_from_data</span><span class='op'>$</span><span class='va'>R</span><span class='op'>$</span><span class='va'>`Mean(R)`</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Anne Cori.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


