<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dealing with missed generations of infections with EpiEstim • EpiEstim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dealing with missed generations of infections with EpiEstim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiEstim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/alternative_software.html">Alternative software for estimating the reproduction number</a>
    </li>
    <li>
      <a href="../articles/EpiEstim_aggregated_data.html">EpiEstim for aggregated incidence data</a>
    </li>
    <li>
      <a href="../articles/EpiEstim_backimputation.html">Dealing with missed generations of infections with EpiEstim</a>
    </li>
    <li>
      <a href="../articles/full_EpiEstim_vignette.html">EpiEstim Vignette</a>
    </li>
    <li>
      <a href="../articles/MV_EpiEstim_vignette.html">MV-EpiEstim</a>
    </li>
    <li>
      <a href="../articles/short_demo.html">EpiEstim: a demonstration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/EpiEstim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dealing with missed generations of infections
with EpiEstim</h1>
                        <h4 data-toc-skip class="author">Andrea
Brizzi</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/EpiEstim/blob/main/vignettes/EpiEstim_backimputation.Rmd" class="external-link"><code>vignettes/EpiEstim_backimputation.Rmd</code></a></small>
      <div class="hidden name"><code>EpiEstim_backimputation.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>When a novel pathogen arises in a population, time may be needed
before surveillance systems are set up and can identify infected
individuals. As such, the start of an epidemic may differ from the date
of first reported case, and epidemiologists may need to take into
account the impact of unobserved generations of infections on their
analyses.</p>
<p>In the case of EpiEstim, the first estimates of the reproduction
number (R<sub>t</sub>) are sensitive to the recent incidence history.
Indeed, the denominator of the estimator depends on the term:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Λ</mi><mi>t</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow><mi>τ</mi><mo>&lt;</mo><mi>t</mi></mrow></munder><msub><mi>w</mi><mrow><mi>t</mi><mo>−</mo><mi>τ</mi></mrow></msub><msub><mi>I</mi><mi>τ</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
\Lambda_t = \sum_{\tau &lt; t} w_{t-\tau} I_\tau,
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>I</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msub><annotation encoding="application/x-tex">(I_t)_{t}</annotation></semantics></math>
denotes incidence and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>j</mi></msub><annotation encoding="application/x-tex">(w_j)_{j}</annotation></semantics></math>
the serial interval distribution. If the first cases are not observed,
this sum will be truncated, hence the denominator will be underestimated
and infectiousness overestimated.</p>
<p>In Brizzi, O’Driscoll and Dorigatti (10.1093/cid/ciac138), we
proposed a simple exponential growth model to impute missed generations
of infections, leading to a reduction in bias in early R<sub>t</sub>
estimates. This can now be implemented through <code>EpiEstim</code>’s
<code>estimate_R</code> function, by setting the
<code>backimputation_window</code> to an integer greater than 2,
specifying the number of observations used to fit the exponential growth
model.</p>
<p>In short, the method combines the strength of the exponential growth
to estimate the basic reproduction number R<sub>0</sub> together with
the capabilities of EpiEstim to detect changes in transmission
dynamics.</p>
</div>
<div class="section level2">
<h2 id="why-do-we-need-backimputation">Why do we need backimputation?<a class="anchor" aria-label="anchor" href="#why-do-we-need-backimputation"></a>
</h2>
<div class="section level3">
<h3 id="a-simple-toy-scenario">A simple toy scenario<a class="anchor" aria-label="anchor" href="#a-simple-toy-scenario"></a>
</h3>
<p>To quickly introduce early overestimation issue, consider the case of
constant incidence, for example
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>t</mi></msub><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">I_t = 10</annotation></semantics></math>.
We would expect R<sub>t</sub> to be constantly close to 1. However,
estimates of R<sub>t</sub> are decreasing, suggesting a reduction in
pathogen infectiousness.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incid_constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_config.html">make_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean_si <span class="op">=</span> <span class="fl">7</span>, std_si <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/estimate_R.html">estimate_R</a></span><span class="op">(</span>incid <span class="op">=</span> <span class="va">incid_constant</span>, config <span class="op">=</span> <span class="va">config</span>, method <span class="op">=</span> <span class="st">"parametric_si"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="st">"R"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Default config will estimate R on weekly sliding windows.</span></span>
<span><span class="co">#&gt;     To change this change the t_start and t_end arguments.</span></span></code></pre></div>
<p><img src="EpiEstim_backimputation_files/figure-html/early-bias-1.png" width="672"></p>
<p>The problem here is that EpiEstim implicitly assumes the 10 cases in
day 2 to have been generated by cases in day 1! If this seems like an
unlikely scenario, perform backimputation by setting
<code>imputation_window</code> to an integer larger than 2. When working
with daily incidence, we suggest to set this window to at least 5
observations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate_R.html">estimate_R</a></span><span class="op">(</span></span>
<span>    incid <span class="op">=</span> <span class="va">incid_constant</span>,</span>
<span>    backimputation_window <span class="op">=</span> <span class="fl">7</span>,</span>
<span>    config <span class="op">=</span> <span class="va">config</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"parametric_si"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="st">"R"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Default config will estimate R on weekly sliding windows.</span></span>
<span><span class="co">#&gt;     To change this change the t_start and t_end arguments.</span></span></code></pre></div>
<p><img src="EpiEstim_backimputation_files/figure-html/early-bias-fix-1.png" width="672"></p>
<p>In this case, the estimates are constant, as expected.</p>
</div>
<div class="section level3">
<h3 id="real-world-scenario-uk-covid-deaths">Real world scenario: UK COVID deaths<a class="anchor" aria-label="anchor" href="#real-world-scenario-uk-covid-deaths"></a>
</h3>
<p>Let us now consider some real world data: UK COVID-19 deaths from
2020. As reporting of deaths is more accurate and reliable than case
reporting, it is unlikely that a large proportion of people died of
COVID before the first reported death. However, we can use this dataset
to show how left-censoring incidence may affect traditional EpiEstim
estimates, and how the adjustment behaves more robustly. We focus on the
first 50 days of reports.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">covid_deaths_2020_uk</span><span class="op">)</span></span>
<span><span class="va">max_t</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">incid_covid</span> <span class="op">&lt;-</span> <span class="va">covid_deaths_2020_uk</span><span class="op">$</span><span class="va">incidence</span><span class="op">$</span><span class="va">Incidence</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">max_t</span><span class="op">]</span></span>
<span><span class="va">config_covid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_config.html">make_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>si_distr <span class="op">=</span> <span class="va">covid_deaths_2020_uk</span><span class="op">$</span><span class="va">si_distr</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="no-left-censoring-early-rt-estimates-remain-similar">No left-censoring: early R<sub>t</sub> estimates remain similar<a class="anchor" aria-label="anchor" href="#no-left-censoring-early-rt-estimates-remain-similar"></a>
</h4>
<p>We first consider a scenario where the back-imputation shouldn’t be
necessary: i.e. when no generations of infections (or deaths) are
missed. We would hope that performing back-imputation would not
drastically lower the estimates for the reproduction number. Indeed,
this is the case.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no_truncation_no_imputation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_R.html">estimate_R</a></span><span class="op">(</span></span>
<span>                                          incid <span class="op">=</span> <span class="va">incid_covid</span>,</span>
<span>                                          method <span class="op">=</span> <span class="st">"non_parametric_si"</span>,</span>
<span>                                          config <span class="op">=</span>  <span class="va">config_covid</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Default config will estimate R on weekly sliding windows.</span></span>
<span><span class="co">#&gt;     To change this change the t_start and t_end arguments.</span></span>
<span><span class="va">no_truncation_with_imputation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_R.html">estimate_R</a></span><span class="op">(</span></span>
<span>                                            backimputation_window <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                                            incid <span class="op">=</span> <span class="va">incid_covid</span>,</span>
<span>                                            method <span class="op">=</span> <span class="st">"non_parametric_si"</span>,</span>
<span>                                            config <span class="op">=</span>  <span class="va">config_covid</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Default config will estimate R on weekly sliding windows.</span></span>
<span><span class="co">#&gt;     To change this change the t_start and t_end arguments.</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">no_truncation_no_imputation</span>, <span class="st">"R"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"No imputation"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">no_truncation_with_imputation</span>, <span class="st">"R"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"With imputation"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="EpiEstim_backimputation_files/figure-html/covid-no-imputation-1.png" width="672">
The reduction in R<sub>t</sub> estimates is strongest in the early
stages, and vanishes with time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="va">no_truncation_no_imputation</span><span class="op">$</span><span class="va">R</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t_start"</span>, <span class="st">"t_end"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">time</span><span class="op">$</span><span class="va">t_end</span>,</span>
<span>  original <span class="op">=</span> <span class="va">no_truncation_no_imputation</span><span class="op">$</span><span class="va">R</span><span class="op">[</span>, <span class="st">"Mean(R)"</span><span class="op">]</span>,</span>
<span>  adjusted <span class="op">=</span> <span class="va">no_truncation_with_imputation</span><span class="op">$</span><span class="va">R</span><span class="op">[</span>, <span class="st">"Mean(R)"</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">estimates</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="op">(</span><span class="va">adjusted</span><span class="op">-</span><span class="va">original</span><span class="op">)</span><span class="op">/</span><span class="va">original</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"#5983AB"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_epiestim</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>     title <span class="op">=</span> <span class="st">"Percent reduction in mean R_t estimate due to imputation"</span>,</span>
<span>     x <span class="op">=</span> <span class="st">"Midpoint of sliding window"</span>,</span>
<span>     y <span class="op">=</span> <span class="st">"Percentage reduction"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use the `linewidth` argument instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="EpiEstim_backimputation_files/figure-html/covid-imputation-comparison-1.png" width="672"></p>
<p>In this case, the shape of the R<sub>t</sub> estimates are similar
for the two methods. Still, the imputation reduces the first
R<sub>t</sub> estimate from 3.8 to 3.1.</p>
</div>
<div class="section level4">
<h4 id="left-censoring-back-imputation-reduces-bias-">Left-censoring: back-imputation reduces bias.<a class="anchor" aria-label="anchor" href="#left-censoring-back-imputation-reduces-bias-"></a>
</h4>
<p>Now let us assume the first two weeks of deaths were not observed.
How would the two methods compare?</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">trunc_t</span> <span class="op">&lt;-</span> <span class="fl">14</span></span>
<span></span>
<span><span class="co"># fit EpiEstim</span></span>
<span><span class="va">truncation_no_imputation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_R.html">estimate_R</a></span><span class="op">(</span></span>
<span>                                     incid <span class="op">=</span> <span class="va">incid_covid</span><span class="op">[</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">trunc_t</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                                     method <span class="op">=</span> <span class="st">"non_parametric_si"</span>,</span>
<span>                                     config <span class="op">=</span> <span class="va">config_covid</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Default config will estimate R on weekly sliding windows.</span></span>
<span><span class="co">#&gt;     To change this change the t_start and t_end arguments.</span></span>
<span></span>
<span><span class="va">truncation_with_imputation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_R.html">estimate_R</a></span><span class="op">(</span></span>
<span>                                   backimputation_window <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                                   incid <span class="op">=</span> <span class="va">incid_covid</span><span class="op">[</span> <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">trunc_t</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                   method <span class="op">=</span> <span class="st">"non_parametric_si"</span>,</span>
<span>                                   config <span class="op">=</span> <span class="va">config_covid</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Default config will estimate R on weekly sliding windows.</span></span>
<span><span class="co">#&gt;     To change this change the t_start and t_end arguments.</span></span>
<span></span>
<span><span class="co"># specify classes</span></span>
<span><span class="va">truncation_with_imputation</span><span class="op">$</span><span class="va">R</span><span class="op">$</span><span class="va">imputation</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">truncation_no_imputation</span><span class="op">$</span><span class="va">R</span><span class="op">$</span><span class="va">imputation</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="va">truncation_with_imputation</span><span class="op">$</span><span class="va">R</span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="va">truncation_no_imputation</span><span class="op">$</span><span class="va">R</span></span>
<span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">t_start</span> <span class="op">+</span> <span class="va">res1</span><span class="op">$</span><span class="va">t_end</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, </span>
<span>                     y <span class="op">=</span> <span class="va">res1</span><span class="op">$</span><span class="va">`Mean(R)`</span>,</span>
<span>                     ymin <span class="op">=</span> <span class="va">res1</span><span class="op">$</span><span class="va">`Quantile.0.025(R)`</span>,</span>
<span>                     ymax <span class="op">=</span> <span class="va">res1</span><span class="op">$</span><span class="va">`Quantile.0.975(R)`</span>, </span>
<span>                     imputation <span class="op">=</span> <span class="va">res1</span><span class="op">$</span><span class="va">imputation</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">test2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">t_start</span> <span class="op">+</span> <span class="va">res2</span><span class="op">$</span><span class="va">t_end</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, </span>
<span>                     y <span class="op">=</span> <span class="va">res2</span><span class="op">$</span><span class="va">`Mean(R)`</span>,</span>
<span>                     ymin <span class="op">=</span> <span class="va">res2</span><span class="op">$</span><span class="va">`Quantile.0.025(R)`</span>,</span>
<span>                     ymax <span class="op">=</span> <span class="va">res2</span><span class="op">$</span><span class="va">`Quantile.0.975(R)`</span>, </span>
<span>                     imputation <span class="op">=</span> <span class="va">res2</span><span class="op">$</span><span class="va">imputation</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">test</span>, <span class="fu">aes</span><span class="op">(</span> </span>
<span>                          x <span class="op">=</span> <span class="va">x</span>,</span>
<span>                          y <span class="op">=</span> <span class="va">y</span>,</span>
<span>                          ymin <span class="op">=</span> <span class="va">ymin</span>,</span>
<span>                          ymax <span class="op">=</span> <span class="va">ymax</span>,</span>
<span>                          color <span class="op">=</span> <span class="va">imputation</span>,</span>
<span>                          fill <span class="op">=</span> <span class="va">imputation</span>,</span>
<span>                          linetype <span class="op">=</span> <span class="va">imputation</span></span>
<span>                          <span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu">geom_ribbon</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">geom_ribbon</span><span class="op">(</span>data <span class="op">=</span> <span class="va">test2</span>, alpha <span class="op">=</span> <span class="fl">.3</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">scale_color_manual</span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#5983AB"</span>, <span class="st">"#E5A3A3"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">scale_fill_manual</span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#5983AB"</span>, <span class="st">"#E5A3A3"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Midpoint of sliding window"</span>, y <span class="op">=</span> <span class="st">"EpiEstim Posterior Mean"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">theme_epiestim</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">test2</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Midpoint of sliding window"</span>, y <span class="op">=</span> <span class="st">"EpiEstim Posterior Mean"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="EpiEstim_backimputation_files/figure-html/unnamed-chunk-1-1.png" width="672"></p>
<p>With truncated deaths data, the imputation procedure brought the
R<sub>t</sub> mean estimate from 3.9 to 2.8 . This is closer to the
estimate obtained from the complete data at the same time point (3).</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="caveats">Caveats<a class="anchor" aria-label="anchor" href="#caveats"></a>
</h2>
<p>The back imputation process is not always necessary, and is not
suggested in the following cases.</p>
<ol style="list-style-type: decimal">
<li>Surveillance is timely set up and case reporting is precise: the
first reported cases are likely the first generations of
infections.</li>
<li>The majority of new cases are imported, hence were not generated by
unseen local infections. In this case, refer to the “Specifying imported
cases” section of the <a href="short_demo.html">original demo</a>.<br>
</li>
<li>Cases are sparsely reported, with frequent 0 cases. The exponential
growth regime may not have started, or other reporting biases may lead
to sensitive estimates of the growth rate.</li>
</ol>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Andrea Brizzi, Megan O’Driscoll, Ilaria Dorigatti, Refining
Reproduction Number Estimates to Account for Unobserved Generations of
Infection in Emerging Epidemics, Clinical Infectious Diseases, Volume
75, Issue 1, 1 July 2022, Pages e114–e121, <a href="https://doi.org/10.1093/cid/ciac138" class="external-link uri">https://doi.org/10.1093/cid/ciac138</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Anne Cori.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
