<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EpiEstim for aggregated incidence data • EpiEstim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="EpiEstim for aggregated incidence data">
<meta property="og:description" content="EpiEstim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiEstim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/EpiEstim_aggregated_data.html">EpiEstim for aggregated incidence data</a>
    </li>
    <li>
      <a href="../articles/MV_EpiEstim_vignette.html">MV-EpiEstim</a>
    </li>
    <li>
      <a href="../articles/alternative_software.html">Alternative software for estimating the reproduction number</a>
    </li>
    <li>
      <a href="../articles/full_EpiEstim_vignette.html">EpiEstim Vignette</a>
    </li>
    <li>
      <a href="../articles/short_demo.html">EpiEstim: a demonstration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/EpiEstim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="EpiEstim_aggregated_data_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>EpiEstim for aggregated incidence data</h1>
                        <h4 data-toc-skip class="author">Rebecca Nash</h4>
            
            <h4 data-toc-skip class="date">2023-04-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/EpiEstim/blob/HEAD/vignettes/EpiEstim_aggregated_data.Rmd" class="external-link"><code>vignettes/EpiEstim_aggregated_data.Rmd</code></a></small>
      <div class="hidden name"><code>EpiEstim_aggregated_data.Rmd</code></div>

    </div>

    
    
<p>The <code>EpiEstim</code> package has been extended to allow users to estimate the time varying reproduction number (R<sub>t</sub>) from temporally aggregated incidence data (Nash et al.). This approach reconstructs daily incidence from data supplied at any timescale. This vignette will take you through the different ways aggregated incidence data can be supplied, the additional parameters needed, and an example using aggregated UK COVID-19 data. Please also see the FAQs section.</p>
<div style="margin-top:30px;">
<h2 id="input-data">Input data</h2>
</div>
<p><strong>Incidence data</strong></p>
<p>Many diseases are not reported on a daily basis. EpiEstim can now use incidence data that has been aggregated in multiple ways, e.g.:</p>
<ul>
<li>Constant aggregations, such as weekly data</li>
<li>Repeating patterns of aggregations, such as regular reporting 3x per week</li>
<li>Variable aggregations over the course of an outbreak</li>
</ul>
<p>Daily incidence data is reconstructed from aggregated data using an expectation-maximisation (EM) algorithm. There are three stages of the EM algorithm:</p>
<ul>
<li>
<strong>Initialisation.</strong> The EM algorithm is initialised with a naive disaggregation of the incidence data. For example, if there were 70 cases over the course of a week, this would be naively split into 10 cases per day.</li>
<li>
<strong>Expectation.</strong> The reproduction number is estimated for each aggregation window, except for the first aggregation window (as there is no past incidence data). This means that the earliest the incidence reconstruction can start is at least the first day of the second aggregation window. Additionally, if the disaggregated incidence in subsequent aggregation windows is too low to estimate the reproduction number, this will mean that the reconstruction will not start until case numbers are sufficiently high.</li>
<li>
<strong>Maximisation.</strong> The reproduction number estimates are then translated into growth rates for each aggregation window (Wallinga &amp; Lipsitch, 2007) and used to reconstruct daily incidence data assuming exponential growth. The daily incidence is adjusted by a constant to ensure that if the daily incidence were to be re-aggregated, it would still sum to the original aggregated totals. The expectation and maximisation steps repeat iteratively until convergence.</li>
</ul>
<p>The daily incidence that is reconstructed after the final iteration of the EM algorithm is then used to estimate R<sub>t</sub> using the same process as the original <code><a href="../reference/estimate_R.html">estimate_R()</a></code> function, with sliding weekly time windows used as the default.</p>
<p><strong>Aggregation windows</strong></p>
<p>Aggregation windows can be specified using the parameter <code>dt</code>, and can be provided in one of three ways:</p>
<ul>
<li>A single integer - for constant aggregation windows, e.g. <code>dt = 7L</code> for weekly data</li>
<li>A repeating vector of integers - for repeating aggregation patterns e.g. reporting 3x per week on the same day of the week could be <code>dt = c(2L,2L,3L)</code>
</li>
<li>A vector of aggregations matching the length of incidence data supplied</li>
</ul>
<p><strong>Serial interval distribution</strong></p>
<p>The serial interval can be provided on a daily timescale (as usual), either as the mean and standard deviation (parametric distribution) or the full distribution (non-parametric distribution). See ‘full_EpiEstim_vignette’ for more details.</p>
<div class="section level3">
<h3 id="estimate-rt-from-temporally-aggregated-incidence-data">Estimate R<sub>t</sub> from temporally aggregated incidence data<a class="anchor" aria-label="anchor" href="#estimate-rt-from-temporally-aggregated-incidence-data"></a>
</h3>
<p>To estimate R<sub>t</sub> from temporally aggregated incidence data, we simply use the <code><a href="../reference/estimate_R.html">estimate_R()</a></code> function with two additional parameters required, <code>dt</code> and <code>dt_out</code>, and two optional parameters, <code>iter</code> and <code>grid</code>.</p>
<div class="section level4">
<h4 id="estimate_r-for-aggregated-data">
<code>estimate_R()</code> for aggregated data<a class="anchor" aria-label="anchor" href="#estimate_r-for-aggregated-data"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate_R.html">estimate_R</a></span><span class="op">(</span>incid <span class="op">=</span> <span class="va">aggregated_incidence</span>,</span>
<span>           dt <span class="op">=</span> <span class="fl">7L</span>,</span>
<span>           dt_out <span class="op">=</span> <span class="fl">7L</span>,</span>
<span>           iter <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>           grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>precision <span class="op">=</span> <span class="fl">0.001</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>           config <span class="op">=</span> <span class="va">config</span>,</span>
<span>           method <span class="op">=</span> <span class="va">method</span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p>As described above, <code>dt</code> can be supplied as a single integer, a vector of repeating integers, or a full vector of integers matching the length of the incidence data.</p></li>
<li><p><code>dt_out</code> is the length of the sliding windows used to estimate R<sub>t</sub> from the reconstructed daily incidence data, this is <code>dt = 7L</code> (weekly sliding windows) by default. We recommend that <code>dt_out</code> is at least equal to the length of the longest aggregation window (<code>dt</code>) in the data.</p></li>
</ul>
<p>There are two optional parameters that can be modified, however, we recommend that the default values are used:</p>
<ul>
<li><p><code>iter</code> is the number of iterations of the EM algorithm used to reconstruct the daily data. This is <code>iter = 10L</code> by default.</p></li>
<li><p><code>grid</code> is a list of “precision”, “min”, and “max” values to define a grid of growth rate parameters used inside the EM algorithm. The grid is used to convert reproduction number estimates for each aggregation of incidence data into growth rates, which are then used to reconstruct the daily incidence data assuming exponential growth. The grid will auto-adjust if it is not large enough, so we recommend using the default values.</p></li>
</ul>
<p>The SI distibution can be specified as normal using the <code>method</code> and <code>config</code> parameters (see the full_EpiEstim_vignette for more details).</p>
<div style="margin-top:30px;">
<h2 id="examples">Examples</h2>
</div>
</div>
</div>
<div class="section level3">
<h3 id="estimate-rt-from-weekly-covid-19-data">Estimate R<sub>t</sub> from weekly COVID-19 data<a class="anchor" aria-label="anchor" href="#estimate-rt-from-weekly-covid-19-data"></a>
</h3>
<p>This example will take you through a workflow using weekly incidence data for UK COVID-19 cases. (For detailed description of the data see Nash et al.)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"./aggregated_data/UK_covid_cases.rds"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Incidence</strong></p>
<p>Let us say we have a vector of weekly incidence data for COVID-19 cases.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incid</span></span>
<span><span class="co">#&gt;  [1]      21     241    1503    4714   14294   27408   33124   30126   33288</span></span>
<span><span class="co">#&gt; [10]   31944   25581   20435   17320   12195    9259    7102    6948    5596</span></span>
<span><span class="co">#&gt; [19]    4376    4258    4287    4704    5507    5964    7408    7500    8244</span></span>
<span><span class="co">#&gt; [28]   13823   22060   23924   41711   66725  106925  116472  146015  150832</span></span>
<span><span class="co">#&gt; [37]  159310  172001  146202  107282  102508  128194  202680  260353  352685</span></span>
<span><span class="co">#&gt; [46]  397790  316549  250624  175157  133220   94886   79373   63185   41334</span></span>
<span><span class="co">#&gt; [55]   38741   37560   37213   27387   19128   16934   16182   14287   13422</span></span>
<span><span class="co">#&gt; [64]   14743   15882   20430   30671   46961   62642   97320  163612  214681</span></span>
<span><span class="co">#&gt; [73]  294984  279099  187392  186748  198318  225124  239123  249063  251378</span></span>
<span><span class="co">#&gt; [82]  199736  235620  234391  244202  292109  326688  280646  255388  253735</span></span>
<span><span class="co">#&gt; [91]  287826  295546  322535  345941  525261  800717 1034989</span></span></code></pre></div>
<p>We need to specify how the data is aggregated, which in this case, is by constant weekly aggregation windows. We do this by supplying <code>dt</code> with a single integer (7L).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fl">7L</span></span></code></pre></div>
<p>We can take an estimate from the literature to specify a parametric SI with a mean of 6.3 days and a standard deviation of 4.2 days (Bi et al 2020).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_si</span> <span class="op">&lt;-</span> <span class="fl">6.3</span></span>
<span><span class="va">std_si</span> <span class="op">&lt;-</span> <span class="fl">4.2</span></span>
<span><span class="va">method</span> <span class="op">&lt;-</span> <span class="st">"parametric_si"</span></span>
<span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_config.html">make_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean_si <span class="op">=</span> <span class="va">mean_si</span>,</span>
<span>                           std_si <span class="op">=</span> <span class="va">std_si</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Estimate R<sub>t</sub></strong></p>
<p>Now that we have our aggregated incidence, our aggregation time window, and SI distribution, we can supply these to the <code><a href="../reference/estimate_R.html">estimate_R()</a></code> function. We do not need to specify <code>dt_out</code>, <code>iter</code> or <code>grid</code> because we are going to use the default values.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">EpiEstim</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_R.html">estimate_R</a></span><span class="op">(</span>incid <span class="op">=</span> <span class="va">incid</span>,</span>
<span>                             dt <span class="op">=</span> <span class="va">dt</span>,</span>
<span>                             method <span class="op">=</span> <span class="va">method</span>,</span>
<span>                             config <span class="op">=</span> <span class="va">config</span><span class="op">)</span></span></code></pre></div>
<p>The output consists of multiple elements, including the reconstructed daily incidence data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">I</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3 3 3 3 3 3</span></span></code></pre></div>
<p>And the R<sub>t</sub> estimates (in this case, using the default weekly sliding windows):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">R</span><span class="op">)</span></span>
<span><span class="co">#&gt;   t_start t_end  Mean(R)    Std(R) Quantile.0.025(R) Quantile.0.05(R)</span></span>
<span><span class="co">#&gt; 1       8    14 5.472053 0.3517569          4.804283         4.906602</span></span>
<span><span class="co">#&gt; 2       9    15 4.940857 0.2770256          4.412755         4.494190</span></span>
<span><span class="co">#&gt; 3      10    16 4.440229 0.2176621          4.023813         4.088375</span></span>
<span><span class="co">#&gt; 4      11    17 4.095384 0.1758868          3.757861         3.810433</span></span>
<span><span class="co">#&gt; 5      12    18 3.865754 0.1457340          3.585360         3.629207</span></span>
<span><span class="co">#&gt; 6      13    19 3.708135 0.1229331          3.471074         3.508271</span></span>
<span><span class="co">#&gt;   Quantile.0.25(R) Median(R) Quantile.0.75(R) Quantile.0.95(R)</span></span>
<span><span class="co">#&gt; 1         5.230868  5.464518         5.705025         6.063209</span></span>
<span><span class="co">#&gt; 2         4.751292  4.935681         5.124780         5.405182</span></span>
<span><span class="co">#&gt; 3         4.291544  4.436673         4.585038         4.804214</span></span>
<span><span class="co">#&gt; 4         3.975417  4.092866         4.212605         4.388922</span></span>
<span><span class="co">#&gt; 5         3.766486  3.863923         3.963027         4.108548</span></span>
<span><span class="co">#&gt; 6         3.624494  3.706777         3.790295         3.912632</span></span>
<span><span class="co">#&gt;   Quantile.0.975(R)</span></span>
<span><span class="co">#&gt; 1          6.182645</span></span>
<span><span class="co">#&gt; 2          5.498376</span></span>
<span><span class="co">#&gt; 3          4.876853</span></span>
<span><span class="co">#&gt; 4          4.447213</span></span>
<span><span class="co">#&gt; 5          4.156555</span></span>
<span><span class="co">#&gt; 6          3.952916</span></span></code></pre></div>
<p>In this example, you will notice that R<sub>t</sub> estimation does not start until day 8. This is because the daily incidence data cannot be reconstructed, and R<sub>t</sub> estimation cannot start, until the first day of the second aggregation window. The start of R<sub>t</sub> estimation may also be delayed if incidence is too low, but this was not the case here.</p>
<p><strong>Plot results</strong></p>
<p>As normal, simply plot the full or partial output.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span> <span class="co"># full output</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">output</span>, <span class="st">"incid"</span><span class="op">)</span> <span class="co"># Reconstructed daily incidence only</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">output</span>, <span class="st">"R"</span><span class="op">)</span> <span class="co"># Rt estimates only</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">output</span>, <span class="st">"SI"</span><span class="op">)</span> <span class="co"># SI estimates only</span></span></code></pre></div>
<p><strong>Check convergence</strong></p>
<p>You can also check convergence by modifying <code>iter=</code> and comparing the results to check for large discrepancies.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_5iter</span> <span class="op">&lt;-</span> <span class="fu">EpiEstim</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_R.html">estimate_R</a></span><span class="op">(</span>incid <span class="op">=</span> <span class="va">incid</span>,</span>
<span>                             dt <span class="op">=</span> <span class="va">dt</span>,</span>
<span>                             iter <span class="op">=</span> <span class="fl">5L</span>,</span>
<span>                             method <span class="op">=</span> <span class="va">method</span>,</span>
<span>                             config <span class="op">=</span> <span class="va">config</span><span class="op">)</span></span>
<span></span>
<span><span class="va">iter_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">R</span>, <span class="va">output_5iter</span><span class="op">$</span><span class="va">R</span><span class="op">)</span></span>
<span><span class="va">nR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">R</span><span class="op">)</span></span>
<span><span class="va">iter_diff</span><span class="op">$</span><span class="va">iter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"10 iterations"</span>,<span class="va">nR</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"5 iterations"</span>,<span class="va">nR</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">iter_diff</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">t_end</span>, <span class="va">`Mean(R)`</span>,group<span class="op">=</span><span class="va">iter</span>,col<span class="op">=</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_manual</span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#3c3b5f"</span>,<span class="st">"#f06553"</span><span class="op">)</span>, name<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`Quantile.0.025(R)`</span>, ymax<span class="op">=</span><span class="va">`Quantile.0.975(R)`</span>, </span>
<span>                  fill<span class="op">=</span><span class="va">iter_diff</span><span class="op">$</span><span class="va">iter</span><span class="op">)</span>, col<span class="op">=</span><span class="cn">NA</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#60B7DE"</span>,<span class="st">"#ff6961"</span><span class="op">)</span>, name<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"R"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="EpiEstim_aggregated_data_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<div style="margin-top:30px;">
<h2 id="faqs">FAQs</h2>
</div>
<ul>
<li><strong>Why does R<sub>t</sub> estimation start later than the start date of the incidence data supplied?</strong></li>
</ul>
<p>In order to reconstruct daily incidence data, the method requires that R<sub>t</sub> is estimated for each aggregation window in turn, which is translated into a growth rate and used to reconstruct daily incidence assuming exponential growth. As there is no past incidence data beyond the first aggregation window, R<sub>t</sub> cannot be estimated and the daily incidence cannot be reconstructed until the first day of the second aggregation window.</p>
<p>Additionally, R<sub>t</sub> estimation will not start until case numbers are sufficiently high.</p>
<p><strong>Please also see the FAQ section in “full_EpiEstim_vignette”.</strong></p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Nash RK, Cori A, Nouvellet P. Estimating the epidemic reproduction number from temporally aggregated incidence data: a statistical modelling approach and software tool. medRxiv pre-print.</p>
<p>Bi Q, et al. Epidemiology and transmission of COVID-19 in 391 cases and 1286 of their close contacts in Shenzhen, China: a retrospective cohort study. Lancet. 2020.</p>
<p>Wallinga J, Lipsitch M. How generation intervals shape the relationship between growth rates and reproductive numbers. Proceedings of the Royal Society B: Biological Sciences. 2007 Feb 22;274(1609):599–604.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Anne Cori.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
