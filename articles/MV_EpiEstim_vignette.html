<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MV-EpiEstim • EpiEstim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MV-EpiEstim">
<meta property="og:description" content="EpiEstim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiEstim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MV_EpiEstim_vignette.html">MV-EpiEstim</a>
    </li>
    <li>
      <a href="../articles/full_EpiEstim_vignette.html">EpiEstim Vignette</a>
    </li>
    <li>
      <a href="../articles/short_demo.html">EpiEstim: a demonstration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/EpiEstim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="MV_EpiEstim_vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MV-EpiEstim</h1>
            
            <h4 data-toc-skip class="date">2022-04-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/EpiEstim/blob/HEAD/vignettes/MV_EpiEstim_vignette.Rmd" class="external-link"><code>vignettes/MV_EpiEstim_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>MV_EpiEstim_vignette.Rmd</code></div>

    </div>

    
    
<p>The <code>EpiEstim</code> package has been extended to allow users to estimate the effective transmission advantage of new pathogens/variants/strains compared to a reference pathogen/variant/strain in real-time. This vignette will take you through the key stages of estimating this advantage and also provide an example of how this method can be applied in a typical outbreak analysis workflow. Please also see the ‘FAQs’ section.</p>
<div style="margin-top:30px;">
<h2 id="input-data">Input data</h2>
</div>
<p>The <strong>incidence data</strong> needs to be supplied in the form of a multidimensional array, containing the incidence for each day of the outbreak (row), location (column) and variant/strain under investigation (third dimension), e.g.:</p>
<table class="table kable_wrapper"><tbody><tr>
<td>
<table class="table">
<caption>
Variant 1
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Region_1
</th>
<th style="text-align:left;">
Region_2
</th>
<th style="text-align:left;">
Region_3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
[1,]
</td>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
102
</td>
<td style="text-align:left;">
58
</td>
</tr>
<tr>
<td style="text-align:left;">
[2,]
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
111
</td>
<td style="text-align:left;">
31
</td>
</tr>
<tr>
<td style="text-align:left;">
[3,]
</td>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
78
</td>
<td style="text-align:left;">
72
</td>
</tr>
<tr>
<td style="text-align:left;">
[4,]
</td>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
150
</td>
<td style="text-align:left;">
85
</td>
</tr>
<tr>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
…
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table class="table">
<caption>
Variant 2
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Region_1
</th>
<th style="text-align:left;">
Region_2
</th>
<th style="text-align:left;">
Region_3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
[1,]
</td>
<td style="text-align:left;">
62
</td>
<td style="text-align:left;">
201
</td>
<td style="text-align:left;">
104
</td>
</tr>
<tr>
<td style="text-align:left;">
[2,]
</td>
<td style="text-align:left;">
48
</td>
<td style="text-align:left;">
230
</td>
<td style="text-align:left;">
59
</td>
</tr>
<tr>
<td style="text-align:left;">
[3,]
</td>
<td style="text-align:left;">
104
</td>
<td style="text-align:left;">
146
</td>
<td style="text-align:left;">
91
</td>
</tr>
<tr>
<td style="text-align:left;">
[4,]
</td>
<td style="text-align:left;">
72
</td>
<td style="text-align:left;">
298
</td>
<td style="text-align:left;">
150
</td>
</tr>
<tr>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
…
</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody></table>
<p>The <strong>serial interval distributions</strong> must be supplied as a matrix with the number of columns matching the number of variants being considered. Each column should contain the probability mass function (PMF) for the discrete serial interval of each variant, starting with the PMF for day zero in the first row (which should be 0) and each column should sum to 1, e.g.:</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Variant_1
</th>
<th style="text-align:left;">
Variant_2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
[1,]
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
[2,]
</td>
<td style="text-align:left;">
0.1
</td>
<td style="text-align:left;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;">
[3,]
</td>
<td style="text-align:left;">
0.3
</td>
<td style="text-align:left;">
0.4
</td>
</tr>
<tr>
<td style="text-align:left;">
[4,]
</td>
<td style="text-align:left;">
0.5
</td>
<td style="text-align:left;">
0.6
</td>
</tr>
<tr>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
…
</td>
<td style="text-align:left;">
…
</td>
</tr>
</tbody>
</table>
<p>##Estimate advantage</p>
<p>To estimate the effective transmission advantage of new variants compared to a reference variant we use the <code><a href="../reference/estimate_advantage.html">estimate_advantage()</a></code> function in <code>EpiEstim</code>.</p>
<p>###<code><a href="../reference/estimate_advantage.html">estimate_advantage()</a></code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/estimate_advantage.html">estimate_advantage</a></span><span class="op">(</span>incid <span class="op">=</span> <span class="va">incidence_object</span>, 
                   si_distr <span class="op">=</span> <span class="va">si_matrix</span>, 
                   priors <span class="op">=</span> <span class="fu"><a href="../reference/default_priors.html">default_priors</a></span><span class="op">(</span><span class="op">)</span>,
                   mcmc_control <span class="op">=</span> <span class="fu"><a href="../reference/default_mcmc_controls.html">default_mcmc_controls</a></span><span class="op">(</span><span class="op">)</span>,
                   t_min <span class="op">=</span> <span class="cn">NULL</span>, t_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">incid</span><span class="op">)</span>,
                   incid_imported <span class="op">=</span> <span class="cn">NULL</span>,
                   precompute <span class="op">=</span> <span class="cn">TRUE</span>,
                   reorder_incid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>As described above, the <code>incid=</code> and <code>si_distr=</code> arguments should be supplied with a multidimensional array of incidence and a matrix containing the serial interval for each variant respectively. In addition, the user can supply:</p>
<ul>
<li><p><code>priors=</code> with a list of the prior parameters (shape and scale) for the reproduction number and the transmission advantage. The default priors can be obtained using the <code><a href="../reference/default_priors.html">default_priors()</a></code> function.</p></li>
<li><p><code>mcmc_control=</code> with a list of the default properties of the MCMC, i.e. the number of iterations, burn-in and the thinning of the MCMC chains. Burn-in is the number of iterations to be discarded as “warm-up”, for instance, if burnin=10 the output is only recorded after 10 iterations have run. Thinning determines how much the MCMC chains should be thinned out, if thin = 10 then 1 in every 10 iterations will be kept. The default parameters can be obtained using <code><a href="../reference/default_mcmc_controls.html">default_mcmc_controls()</a></code>.</p></li>
<li><p><code>t_min=</code> and <code>t_max=</code> with integers that give the minimum and maximum time step over which the transmission advantage will be estimated. Note that cases before <code>t_min</code> will still be accounted for as potential infectors in the likelihood. Indeed, cases before <code>t_min</code> can contribute to the overall infectiousness from t_min to t_max through the serial interval distribution. <code>t_min</code> must be &gt;1 and if <code>t_min = NULL</code> then this is automatically calculated as the maximum of the 95th percentile of the SI distribution. <code>t_max</code> must be &gt; <code>t_min</code> and &lt;= the number of rows of the incidence data. The default value of <code>t_max</code> is <code>nrow(incid)</code>.</p></li>
</ul>
<p>Other optional parameters include:</p>
<ul>
<li><p><code>incid_imported=</code> where a multidimensional array can be supplied (row = time, column = location, third dimension = variant) containing the incidence of imported cases, such that <code>incid - incid_imported</code> would be the incidence of locally infected cases. If <code>incid_imported = NULL</code> it will be assumed that (other than in the first time step) all cases arose from local transmission.</p></li>
<li><p><code>precompute=</code> which can be <code>TRUE</code> or <code>FALSE</code>, but defaults to <code>TRUE</code>. This determines whether the shape of the posterior distributions for R and the transmission advantage (for the non-reference variant(s)) for each time step and location should be precalculated. This makes <code><a href="../reference/estimate_advantage.html">estimate_advantage()</a></code> faster, only use <code>precompute=FALSE</code> for debugging.</p></li>
<li><p><code>reorder_incid=</code> which can be <code>TRUE</code> or <code>FALSE</code>, but defaults to <code>TRUE</code>. If <code>TRUE</code> then during the estimation of the transmission advantage the incidence array will be temporarily re-ordered so that all variants are compared to the most transmissible variant (temporarily considered the reference) regardless of the order in which the user supplied the data. Note that the results will always be returned in the order supplied by the user. We recommend that this is set to <code>TRUE</code>.</p></li>
</ul>
<div style="margin-top:30px;">
<h1 id="examples">Examples</h1>
</div>
<div class="section level3">
<h3 id="sars-cov-2-variants">SARS-CoV-2 variants<a class="anchor" aria-label="anchor" href="#sars-cov-2-variants"></a>
</h3>
<p>This example will take you through a workflow using incidence data for two variants of SARS-CoV-2 (wildtype and alpha) across 7 NHS regions in England. (For detailed description of the data see Bhatia et al. 2021)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">incid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"./data_mv_vignette/incid.rds"</span><span class="op">)</span></code></pre></div>
<p><strong>Incidence</strong></p>
<p>Let us say we have incidence data in the format below, where each row corresponds to a time step in the outbreak, each column corresponds to a region in England, and each third dimension corresponds to a variant.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">incid</span><span class="op">)</span>
<span class="co">#&gt; , , wild</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      East of England London Midlands North East and Yorkshire North West</span>
<span class="co">#&gt; [1,]               7     19       28                       21         37</span>
<span class="co">#&gt; [2,]               8     20       44                       30         48</span>
<span class="co">#&gt; [3,]              10     19       43                       30         48</span>
<span class="co">#&gt; [4,]              10     23       52                       30         58</span>
<span class="co">#&gt; [5,]               8     23       46                       36         53</span>
<span class="co">#&gt; [6,]               6     19       32                       14         37</span>
<span class="co">#&gt;      South East South West</span>
<span class="co">#&gt; [1,]          7          8</span>
<span class="co">#&gt; [2,]         10          7</span>
<span class="co">#&gt; [3,]         11          6</span>
<span class="co">#&gt; [4,]         10          6</span>
<span class="co">#&gt; [5,]         12          5</span>
<span class="co">#&gt; [6,]         13          2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , alpha</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      East of England London Midlands North East and Yorkshire North West</span>
<span class="co">#&gt; [1,]               0      0        1                        0          0</span>
<span class="co">#&gt; [2,]               0      1        1                        0          1</span>
<span class="co">#&gt; [3,]               0      0        1                        0          0</span>
<span class="co">#&gt; [4,]               1      0        1                        0          0</span>
<span class="co">#&gt; [5,]               0      0        0                        0          0</span>
<span class="co">#&gt; [6,]               0      0        0                        0          1</span>
<span class="co">#&gt;      South East South West</span>
<span class="co">#&gt; [1,]          0          0</span>
<span class="co">#&gt; [2,]          0          0</span>
<span class="co">#&gt; [3,]          1          1</span>
<span class="co">#&gt; [4,]          0          0</span>
<span class="co">#&gt; [5,]          0          0</span>
<span class="co">#&gt; [6,]          0          0</span></code></pre></div>
<p>We also assume that the SI is the same for both variants, with a mean of 5.4 days and a standard deviation of 1.5 days (Rai, Shukla, and Dwivedi 2021) and produce a matrix of SI’s with the number of columns equal to the number of variants:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mean_SI</span> <span class="op">&lt;-</span> <span class="fl">5.4</span>
<span class="va">sd_SI</span> <span class="op">&lt;-</span> <span class="fl">1.5</span>
<span class="va">SI</span> <span class="op">&lt;-</span> <span class="fu">EpiEstim</span><span class="fu">::</span><span class="fu"><a href="../reference/discr_si.html">discr_si</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, <span class="va">mean_SI</span>, <span class="va">sd_SI</span><span class="op">)</span>
<span class="va">si_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">SI</span>,<span class="va">SI</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">si_matrix</span><span class="op">)</span>
<span class="co">#&gt;                SI           SI</span>
<span class="co">#&gt; [1,] 0.000000e+00 0.000000e+00</span>
<span class="co">#&gt; [2,] 4.674689e-05 4.674689e-05</span>
<span class="co">#&gt; [3,] 8.034951e-03 8.034951e-03</span>
<span class="co">#&gt; [4,] 7.964056e-02 7.964056e-02</span>
<span class="co">#&gt; [5,] 2.125381e-01 2.125381e-01</span>
<span class="co">#&gt; [6,] 2.683362e-01 2.683362e-01</span></code></pre></div>
<p><strong>Estimate transmission advantage</strong></p>
<p>Now that we have our incidence and SI distributions we can supply these to the <code><a href="../reference/estimate_advantage.html">estimate_advantage()</a></code> function. We use the default priors and MCMC controls.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu">EpiEstim</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_advantage.html">estimate_advantage</a></span><span class="op">(</span>incid <span class="op">=</span> <span class="va">incid</span>,
                             si_distr <span class="op">=</span> <span class="va">si_matrix</span>,
                             priors <span class="op">=</span> <span class="fu"><a href="../reference/default_priors.html">default_priors</a></span><span class="op">(</span><span class="op">)</span>,
                             mcmc_control <span class="op">=</span> <span class="fu"><a href="../reference/default_mcmc_controls.html">default_mcmc_controls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Called from: make_config(incid = incid, method = method, config = config)</span>
<span class="co">#&gt; debug: incid &lt;- process_I(incid)</span>
<span class="co">#&gt; debug: T &lt;- nrow(incid)</span>
<span class="co">#&gt; debug: if (is.null(config$t_start) || is.null(config$t_end)) {</span>
<span class="co">#&gt;     msg &lt;- "Default config will estimate R on weekly sliding windows.\n    To change this change the t_start and t_end arguments. "</span>
<span class="co">#&gt;     message(msg)</span>
<span class="co">#&gt;     config$t_start &lt;- seq(2, T - 6)</span>
<span class="co">#&gt;     config$t_end &lt;- seq(8, T)</span>
<span class="co">#&gt; } else {</span>
<span class="co">#&gt;     check_times(config$t_start, config$t_end, T)</span>
<span class="co">#&gt; }</span>
<span class="co">#&gt; debug: check_times(config$t_start, config$t_end, T)</span>
<span class="co">#&gt; debug: class(config) &lt;- "estimate_R_config"</span>
<span class="co">#&gt; debug: return(config)</span>
<span class="co">#&gt; Called from: make_config(incid = incid, method = method, config = config)</span>
<span class="co">#&gt; debug: incid &lt;- process_I(incid)</span>
<span class="co">#&gt; debug: T &lt;- nrow(incid)</span>
<span class="co">#&gt; debug: if (is.null(config$t_start) || is.null(config$t_end)) {</span>
<span class="co">#&gt;     msg &lt;- "Default config will estimate R on weekly sliding windows.\n    To change this change the t_start and t_end arguments. "</span>
<span class="co">#&gt;     message(msg)</span>
<span class="co">#&gt;     config$t_start &lt;- seq(2, T - 6)</span>
<span class="co">#&gt;     config$t_end &lt;- seq(8, T)</span>
<span class="co">#&gt; } else {</span>
<span class="co">#&gt;     check_times(config$t_start, config$t_end, T)</span>
<span class="co">#&gt; }</span>
<span class="co">#&gt; debug: check_times(config$t_start, config$t_end, T)</span>
<span class="co">#&gt; debug: class(config) &lt;- "estimate_R_config"</span>
<span class="co">#&gt; debug: return(config)</span></code></pre></div>
<p>The output is a list containing 4 elements:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output</span><span class="op">$</span><span class="va">epsilon</span></code></pre></div>
<ul>
<li>epsilon - the estimated effective transmission advantage. This is a matrix containing the MCMC chain (thinned and after burnin) for the relative transmissibility of the “new” variant (alpha) compared to the reference variant (wildtype) across all locations. Each row in the matrix is a “new” variant (in this case only 1) and each column an iteration of the MCMC. If epsilon &gt;1 then the corresponding variant is estimated to have a transmission advantage over the reference variant.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output</span><span class="op">$</span><span class="va">R</span></code></pre></div>
<ul>
<li>R - the reproduction number estimate for the reference variant. This is an array containing the MCMC chain (thinned and after burnin) for the reproduction number of the reference variant. The first dimension of the array is time, the second is the location, and the third is the iteration of the MCMC.</li>
</ul>
<p>In this example, we did not specify <code>t_min=</code> or <code>t_max=</code>. You will notice that the R estimates do not start until day 25, this is because: 1) One of the regions doesn’t have cases of the alpha variant until day 16, 2) The 95th percentile of the SI is 9 days.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output</span><span class="op">$</span><span class="va">convergence</span></code></pre></div>
<ul>
<li>convergence - result of the Gelman-Rubin convergence diagnostic. This is either ‘TRUE’ or ‘FALSE’ and tells you whether the corresponding epsilon MCMC chain for each “new” variant has converged within the number of iterations specified.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output</span><span class="op">$</span><span class="va">diag</span></code></pre></div>
<ul>
<li>diag - nested list of the point estimate and upper confidence limits of the Gelman-Rubin convergence diagnostics (as implemented in the R package <code>coda</code>). The length of diag is equal to the number of rows in epsilon (i.e. the number of non-reference variants, in this case only 1). Each element of diag contains a named list of the point estimate and upper confidence limits.</li>
</ul>
<p><strong>Summarise results</strong></p>
<p>To summarise the estimated transmission advantage one can use the posterior median and 95% CrI as follows.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">epsilon</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.025</span>,<span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;      50%     2.5%    97.5% </span>
<span class="co">#&gt; 1.493312 1.472896 1.505744</span></code></pre></div>
<div style="margin-top:30px;">
<h2 id="faqs">FAQs</h2>
</div>
<ul>
<li><strong>Why should the estimates of the reproduction number produced by <code><a href="../reference/estimate_advantage.html">estimate_advantage()</a></code> be interpreted with caution?</strong></li>
</ul>
<p>The inference framework jointly estimates the instantaneous reproduction number of the reference variant and the effective transmission advantage of new variants. R estimates here should be interpreted with caution because they represent estimates from the joint distribution of the reproduction number and transmission advantage, therefore depending on the incidence of the reference <em>as well as</em> the new variant(s). Moreover, temporal variation in estimates of the instantaneous reproduction number can arise from a number of factors, such as the implementation of control measures, changes in population behaviour, or variability in the reporting of cases over time. If only interested in estimating the reference R<sub>t</sub>, we recommend using <code><a href="../reference/estimate_R.html">estimate_R()</a></code>.</p>
<ul>
<li><strong>What do some of the common warning/error messages mean?</strong></li>
</ul>
<pre><code><span class="st">"The Gelman-Rubin algorithm suggests the MCMC may not have converged within the number of iterations specified."</span></code></pre>
<p>This means that the MCMC chains for the estimation have not converged. To avoid this you may need to run <code><a href="../reference/estimate_advantage.html">estimate_advantage()</a></code> with more MCMC iterations. E.g. by altering <code>mcmc_control()</code>.</p>
<pre><code><span class="st">"Input SI distributions should sum to 1. Normalising now"</span></code></pre>
<p>The SI distributions supplied have been re-normalised so that they sum to 1.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Anne Cori.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
